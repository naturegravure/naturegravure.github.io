<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hommage √† SCIONI RAFFAELE</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Styles suppl√©mentaires pour la bougie et messages */
    #candleBtn { font-size: 2em; padding: 10px 20px; margin-top: 20px; cursor: pointer; }
    #counter { font-size: 1.2em; margin-top: 10px; }
    #messages { margin-top: 40px; }
    .message { border-bottom: 1px solid #ccc; padding: 10px 0; }
    .message .ts { font-size: 0.9em; color: #666; }
    #msgForm { margin-top: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Hommage √† SCIONI RAFFAELE</h1>
      <p class="dates">07.12.1904 ‚Äì 10.09.1990</p>
    </header>

    <section class="portrait">
      <img src="SCIONI_RAFAELE.jpg" alt="Portrait de SCIONI RAFFAELE">
    </section>

    <section class="texte">
      <p>Avec patience et passion, Raffaele a parcouru for√™ts et clairi√®res, toujours guid√© par le chant des oiseaux et la beaut√© de la nature. Chasseur habile et respectueux, il savait allier courage et sagesse, transmettant √† tous autour de lui l‚Äôamour des grands espaces et le respect de la faune. Son regard attentif et sa pr√©cision l√©gendaire resteront √† jamais dans nos m√©moires.</p>

      <p>Raffaele restera √† jamais dans nos c≈ìurs, non seulement comme un chasseur passionn√©, mais surtout comme un p√®re, fr√®re et ami extraordinaire. Sa famille se souvient de chaque instant pass√© avec lui dans les bois, de son rire chaleureux au retour de la chasse et de sa g√©n√©rosit√© sans limite. Chaque souvenir partag√© est un tr√©sor que nous ch√©rirons pour toujours.</p>
    </section>

    <section class="infos">
      <h2>Informations sur la c√©r√©monie</h2>
      <p><strong>Lieu :</strong> Cath√©drale Sainte Marie de Cagliari</p>
      <p><strong>Date et heure :</strong> 15.09.1990 √† 10h00</p>
      <p><strong>Contact :</strong> natureetgravure@gmail.ch</p>
    </section>

    <!-- Section Bougie et compteur -->
    <section class="bougie">
      <button id="candleBtn">üïØ Allumer la bougie</button>
      <div id="counter">Chargement‚Ä¶</div>
    </section>

    <!-- Section Formulaire -->
    <section class="messages">
      <h2>Laisse un message</h2>
      <form id="msgForm">
        <label>
          Ton nom:<br>
          <input type="text" name="name" required>
        </label><br><br>
        <label>
          Ton message:<br>
          <textarea name="message" rows="4" cols="50" required></textarea>
        </label><br><br>
        <button type="submit">Envoyer</button>
      </form>

      <div id="messages">
        <h2>Messages</h2>
        <div id="msgList">Chargement‚Ä¶</div>
      </div>
    </section>

    <footer>
      <p>&copy; Nature & Gravure</p>
    </footer>
  </div>

  <script>
    const BASE_URL = "https://script.google.com/macros/s/AKfycbzeSEPrzC79BlWCa5Xk3spNNndKRE2TCYLhBwsm0kVioGu-hiNEaZyuWMHuEHlXlQQ4/exec";

    function updateCounter() {
      fetch(BASE_URL + '?action=getCount')
        .then(r => r.json())
        .then(d => {
          document.getElementById('counter').innerText = "Nombre de bougies : " + d.count;
        })
        .catch(console.error);
    }

    document.getElementById('candleBtn').addEventListener('click', () => {
      fetch(BASE_URL + '?action=incrementCount')
        .then(r => r.json())
        .then(d => {
          document.getElementById('counter').innerText = "Nombre de bougies : " + d.count;
        })
        .catch(console.error);
    });

    document.getElementById('msgForm').addEventListener('submit', e => {
      e.preventDefault();
      const data = new FormData(e.target);
      const params = new URLSearchParams();
      for (const pair of data.entries()) {
        params.append(pair[0], pair[1]);
      }
      fetch(BASE_URL + '?action=postMessage&' + params.toString())
        .then(r => r.json())
        .then(d => {
          e.target.reset();
          loadMessages();
        })
        .catch(console.error);
    });

    function loadMessages() {
      fetch(BASE_URL + '?action=getMessages')
        .then(r => r.json())
        .then(d => {
          const cont = document.getElementById('msgList');
          if (d.messages && d.messages.length) {
            cont.innerHTML = d.messages.map(m =>
              `<div class="message"><strong>${m.name}</strong> <span class="ts">(${m.timestamp})</span><br>${m.text}</div>`
            ).join('');
          } else {
            cont.innerHTML = "<em>Aucun message pour l'instant.</em>";
          }
        })
        .catch(console.error);
    }

    // Initialisation
    updateCounter();
    loadMessages();
  </script>
</body>
</html>
